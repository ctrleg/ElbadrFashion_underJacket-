<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elbadr Fashion - Premium Winter Jacket</title>
    <meta name="description" content="Elbadr Fashion - High quality winter jackets. Shipping to all cities.">

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-XXXXXXX');
    </script>

    <!-- 
    =======================================================================
    DEPLOYMENT INSTRUCTIONS
    =======================================================================
    
    1. GitHub Pages:
       - Create a new repository on GitHub.
       - Upload 'index.html' and the 'images' folder.
       - Go to Settings > Pages > Source > Select 'main' branch > Save.
    
    2. Netlify:
       - Drag and drop the project folder (containing index.html and images) 
         into the Netlify dashboard.
    
    3. Vercel:
       - Install Vercel CLI: npm i -g vercel
       - Run 'vercel' in this directory and follow the prompts.
       - OR connect your GitHub repo to Vercel dashboard.
    =======================================================================
    -->

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #D4AF37;
            /* Gold */
            --primary-dark: #B4941F;
            --dark: #1a1a1a;
            --light: #f8f9fa;
            --text: #333;
            --text-light: #666;
            --danger: #dc3545;
            --success: #28a745;
            --white: #ffffff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --radius: 8px;
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --font-ar: 'Cairo', sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-main);
            line-height: 1.6;
            color: var(--text);
            background-color: var(--light);
            padding-top: 60px;
            /* For fixed countdown */
        }

        /* Arabic Font Override */
        [lang="ar"] body {
            font-family: var(--font-ar);
        }

        /* Ensure form elements inherit font */
        button,
        input,
        select,
        textarea {
            font-family: inherit;
        }

        /* Utilities */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .btn {
            display: inline-block;
            padding: 12px 30px;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
        }

        .btn-primary {
            background-color: var(--primary);
            color: var(--dark);
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        /* Specific style for WhatsApp button */
        #submitBtn {
            background-color: var(--success);
            color: var(--white);
        }

        #submitBtn:hover {
            background-color: #218838;
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        /* Countdown Bar */
        .countdown-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: var(--dark);
            color: var(--white);
            text-align: center;
            padding: 10px 0;
            z-index: 1000;
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .countdown-timer {
            color: var(--primary);
            margin: 0 5px;
        }

        /* Header */
        header {
            background: var(--white);
            box-shadow: var(--shadow);
            padding: 15px 0;
            position: sticky;
            top: 44px;
            /* Height of countdown */
            z-index: 900;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .brand {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--dark);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .brand span {
            color: var(--primary);
        }

        .lang-switch {
            background: none;
            border: 1px solid var(--dark);
            padding: 5px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
        }

        /* Hero Section */
        .hero {
            padding: 40px 0;
        }

        .hero-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: start;
        }

        @media (max-width: 768px) {
            .hero-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .container {
                padding: 0 15px;
            }

            .hero {
                padding: 20px 0;
            }

            .order-section {
                padding: 20px;
                margin-top: 20px;
            }

            .product-info h1 {
                font-size: 1.5rem;
            }

            .price-tag {
                font-size: 1.25rem;
            }
        }

        /* Gallery */
        .gallery {
            position: relative;
            min-width: 0;
            /* Fix for Grid overflow */
        }

        .main-image {
            width: 100%;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 10px;
            aspect-ratio: 1/1;
            object-fit: cover;
            cursor: pointer;
        }

        .thumbnails {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 10px;
            max-width: 100%;
            scrollbar-width: thin;
        }

        .thumbnails::-webkit-scrollbar {
            height: 6px;
        }

        .thumbnails::-webkit-scrollbar-thumb {
            background-color: #ccc;
            border-radius: 3px;
        }

        .thumb {
            width: 80px;
            height: 80px;
            border-radius: var(--radius);
            cursor: pointer;
            opacity: 0.6;
            transition: 0.3s;
            object-fit: cover;
            border: 2px solid transparent;
            flex-shrink: 0;
        }

        .thumb.active {
            opacity: 1;
            border-color: var(--primary);
        }

        /* Product Info */
        .product-info {
            min-width: 0;
            /* Fix for Grid overflow */
        }

        .product-info h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .price-tag {
            font-size: 1.5rem;
            color: var(--primary-dark);
            font-weight: bold;
            margin-bottom: 20px;
        }

        .features {
            list-style: none;
            margin-bottom: 20px;
        }

        .features li {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .features li::before {
            content: "✓";
            color: var(--success);
            font-weight: bold;
            margin-inline-end: 10px;
        }

        .shipping-note {
            margin-top: 15px;
            font-weight: bold;
            color: #155724;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
        }

        .shipping-note::before {
            content: "🚚";
            font-size: 1.4rem;
        }

        /* Pricing Table */
        .pricing-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--white);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .pricing-table th,
        .pricing-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .pricing-table th {
            background-color: var(--dark);
            color: var(--white);
        }

        .pricing-table tr:last-child td {
            border-bottom: none;
        }

        .pricing-table tr:hover {
            background-color: #f9f9f9;
        }

        /* Order Form */
        .order-section {
            background: var(--white);
            padding: 30px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-top: 30px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: var(--radius);
            font-size: 1rem;
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .order-items {
            margin-bottom: 20px;
            border: 1px solid #eee;
            padding: 15px;
            border-radius: var(--radius);
        }

        .item-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr auto;
            gap: 10px;
            margin-bottom: 10px;
            align-items: end;
        }

        .remove-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }

        .add-item-btn {
            background: var(--text-light);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        /* Visitor Counter */
        .visitor-counter {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: var(--text-light);
            font-size: 0.9rem;
            border-top: 1px solid #eee;
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: var(--white);
            text-align: center;
            padding: 30px 0;
            margin-top: 50px;
        }

        /* RTL/LTR Specifics */
        [dir="rtl"] .features li::before {
            margin-left: 10px;
            margin-right: 0;
        }

        [dir="ltr"] .features li::before {
            margin-right: 10px;
            margin-left: 0;
        }

        /* Lightbox */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .lightbox.active {
            display: flex;
        }

        .lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 80vh;
            transition: transform 0.3s ease;
            cursor: zoom-in;
        }

        .lightbox-content.zoomed {
            transform: scale(2);
            cursor: zoom-out;
        }

        .lightbox-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            background: none;
            border: none;
            z-index: 2001;
        }

        .lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 15px;
            cursor: pointer;
            font-size: 1.5rem;
            border-radius: 50%;
            transition: 0.3s;
        }

        .lightbox-nav:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .prev-btn {
            left: 20px;
        }

        .next-btn {
            right: 20px;
        }

        /* Order Summary */
        .order-summary {
            background: #e9ecef;
            padding: 15px;
            border-radius: var(--radius);
            margin: 20px 0;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #dee2e6;
        }

        .summary-total {
            color: var(--success);
            font-size: 1.2rem;
        }
    </style>
</head>

<body>

    <!-- Countdown Bar -->
    <div class="countdown-bar" id="countdownBar">
        <span id="countdownText">⚡ عرض خاص ينتهي خلال:</span>
        <span class="countdown-timer" id="timer">27:00:00</span>
    </div>

    <!-- Header -->
    <header>
        <div class="container header-content">
            <div class="brand">Elbadr <span>Fashion</span></div>
            <button class="lang-switch" onclick="toggleLanguage()">English</button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container hero">
        <div class="hero-grid">
            <!-- Gallery -->
            <div class="gallery">
                <img src="images/newimages/product_1.jpg" alt="Jacket Front" class="main-image" id="mainImage">
                <div class="thumbnails">
                    <img src="images/newimages/product_1.jpg" class="thumb active" onclick="changeImage(this)">
                    <img src="images/newimages/product_2.jpg" class="thumb" onclick="changeImage(this)">
                    <img src="images/newimages/product_3.jpg" class="thumb" onclick="changeImage(this)">
                    <img src="images/newimages/product_4.jpg" class="thumb" onclick="changeImage(this)">
                    <img src="images/newimages/product_5.jpg" class="thumb" onclick="changeImage(this)">
                    <img src="images/newimages/product_6.jpg" class="thumb" onclick="changeImage(this)">
                    <img src="images/newimages/product_7.jpg" class="thumb" onclick="changeImage(this)">
                    <img src="images/newimages/product_8.jpg" class="thumb" onclick="changeImage(this)">
                    <img src="images/newimages/product_9.jpg" class="thumb" onclick="changeImage(this)">
                    <img src="images/newimages/product_10.jpg" class="thumb" onclick="changeImage(this)">
                </div>
            </div>

            <!-- Product Details -->
            <div class="product-info">
                <h1 id="productTitle">الأندر جاكت وصل!</h1>
                <p id="productDesc">خامة تقيلة، شكل مظبوط، ومناسب من 40 لـ130 كجم.</p>

                <div class="price-tag" id="priceTag">سعر القطعة: 150 ج</div>

                <ul class="features" id="featuresList">
                    <li>خامة عالية الجودة</li>
                    <li>تلبيس مريح جداً</li>
                    <li>متوفر بجميع المقاسات</li>
                </ul>

                <!-- Pricing Table -->
                <table class="pricing-table">
                    <thead>
                        <tr>
                            <th id="qtyHeader">الكمية</th>
                            <th id="priceHeader">السعر الإجمالي</th>
                        </tr>
                    </thead>
                    <tbody id="pricingBody">
                        <!-- Filled by JS -->
                    </tbody>
                </table>

                <p class="shipping-note" id="shippingText">الشحن لكل المحافظات.</p>
            </div>
        </div>

        <!-- Order Section -->
        <section class="order-section" id="orderFormSection">
            <h2 style="margin-bottom: 20px; text-align: center;" id="orderTitle">اطلب الآن</h2>

            <form id="orderForm" onsubmit="submitOrder(event)">
                <div class="order-items" id="orderItems">
                    <!-- Dynamic Items -->
                </div>
                <button type="button" class="add-item-btn" onclick="addOrderItem()" id="addMoreBtn">+ أضف قطعة
                    أخرى</button>

                <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">

                <div class="form-group">
                    <label class="form-label" id="lblFullName">الاسم بالكامل</label>
                    <input type="text" class="form-control" id="fullName" required>
                </div>

                <div class="form-group">
                    <label class="form-label" id="lblPhone">رقم الهاتف</label>
                    <input type="tel" class="form-control" id="phone" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" id="lblGov">المحافظة</label>
                        <input type="text" class="form-control" id="governorate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="lblCity">المدينة</label>
                        <input type="text" class="form-control" id="city" required>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" id="lblAddress">العنوان بالتفصيل (الشارع - علامة مميزة)</label>
                    <textarea class="form-control" id="address" rows="2" required></textarea>
                </div>

                <button type="submit" class="btn btn-primary btn-block" id="submitBtn">
                    🛒 اطلب عبر واتساب
                </button>
            </form>
        </section>

        <div class="visitor-counter">
            <span id="visitorText">عدد الزوار:</span> <span id="visitorCount">0</span>
        </div>
    </main>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <button class="lightbox-close" onclick="closeLightbox()">&times;</button>
        <button class="lightbox-nav prev-btn" onclick="changeSlide(-1)">&#10094;</button>
        <img src="" class="lightbox-content" id="lightboxImg" onclick="toggleZoom()">
        <button class="lightbox-nav next-btn" onclick="changeSlide(1)">&#10095;</button>
    </div>

    <footer>
        <p>&copy; 2025 Elbadr Fashion. All rights reserved.</p>
    </footer>

    <script>
        // --- Configuration & State ---
        const CONFIG = {
            whatsappNumber: "201102448858",
            countdownHours: 23,
            prices: [
                { qty: 1, price: 150 },
                { qty: 2, price: 240 },
                { qty: 3, price: 300 },
                { qty: 4, price: 380 },
                { qty: 5, price: 450 },
                { qty: 6, price: 510 },
                { qty: 7, price: 560 },
                { qty: 8, price: 640 },
                { qty: 9, price: 720 },
                { qty: 10, price: 800 }
            ]
        };

        const TEXTS = {
            ar: {
                dir: "rtl",
                countdown: "⚡ عرض خاص ينتهي خلال:",
                langBtn: "English",
                title: "الأندر جاكت وصل!",
                desc: "خامة تقيلة، شكل مظبوط، ومناسب من 40 لـ130 كجم.",
                priceTag: "سعر القطعة: 150 ج",
                features: ["خامة عالية الجودة", "تلبيس مريح جداً", "متوفر بجميع المقاسات"],
                qtyHeader: "الكمية",
                priceHeader: "السعر",
                shipping: "الشحن لكل المحافظات.",
                orderTitle: "اطلب الآن",
                addMore: "+ أضف قطعة أخرى",
                lblFullName: "الاسم بالكامل",
                lblPhone: "رقم الهاتف",
                lblGov: "المحافظة",
                lblCity: "المدينة",
                lblAddress: "العنوان بالتفصيل",
                submitBtn: "🛒 اطلب عبر واتساب",
                visitorText: "عدد الزوار:",
                colors: ["AMERICAN EAGLE", "MSICROW", "TOMMY JEANS", "BLACK ORIGINAL DENIM", "Snapchat", "GUCCI", "FABULOUS", "INVEST IN YOURSELF", "EMERALD", "CONCRETE COLLECTION"],
                sizes: ["M", "L", "XL", "2XL", "3XL"],
                lblColor: "اللون",
                lblSize: "المقاس",
                lblQty: "العدد",
                lblNote: "ملاحظة"
            },
            en: {
                dir: "ltr",
                countdown: "⚡ Special Offer Ends in:",
                langBtn: "عربي",
                title: "Under Jacket is now available!",
                desc: "Heavy material, perfect fit, fits from 40 to 130 kg.",
                priceTag: "1 Piece: 150 EGP",
                features: ["High Quality Material", "Perfect Fit", "All Sizes Available"],
                qtyHeader: "Quantity",
                priceHeader: "Price",
                shipping: "Shipping to all cities.",
                orderTitle: "Order Now",
                addMore: "+ Add Another Item",
                lblFullName: "Full Name",
                lblPhone: "Phone Number",
                lblGov: "Governorate",
                lblCity: "City",
                lblAddress: "Full Address",
                submitBtn: "🛒 Order via WhatsApp",
                visitorText: "Visitors:",
                colors: ["AMERICAN EAGLE", "MSICROW", "TOMMY JEANS", "BLACK ORIGINAL DENIM", "Snapchat", "GUCCI", "FABULOUS", "INVEST IN YOURSELF", "EMERALD", "CONCRETE COLLECTION"],
                sizes: ["M", "L", "XL", "2XL", "3XL"],
                lblColor: "Color",
                lblSize: "Size",
                lblQty: "Qty",
                lblNote: "Note"
            }
        };

        let currentLang = 'ar';

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initVisitorCounter();
            initCountdown();
            renderPricingTable();
            addOrderItem(); // Add first item row
            updateLanguage();
        });

        // --- Language Switcher ---
        function toggleLanguage() {
            currentLang = currentLang === 'ar' ? 'en' : 'ar';
            updateLanguage();
        }

        function updateLanguage() {
            const t = TEXTS[currentLang];
            document.documentElement.lang = currentLang;
            document.documentElement.dir = t.dir;

            // Update static texts
            document.querySelector('.lang-switch').textContent = t.langBtn;
            document.getElementById('countdownText').textContent = t.countdown;
            document.getElementById('productTitle').textContent = t.title;
            document.getElementById('productDesc').textContent = t.desc;
            document.getElementById('priceTag').textContent = t.priceTag;
            document.getElementById('shippingText').textContent = t.shipping;
            document.getElementById('orderTitle').textContent = t.orderTitle;
            document.getElementById('addMoreBtn').textContent = t.addMore;
            document.getElementById('lblFullName').textContent = t.lblFullName;
            document.getElementById('lblPhone').textContent = t.lblPhone;
            document.getElementById('lblGov').textContent = t.lblGov;
            document.getElementById('lblCity').textContent = t.lblCity;
            document.getElementById('lblAddress').textContent = t.lblAddress;
            document.getElementById('submitBtn').textContent = t.submitBtn;
            document.getElementById('visitorText').textContent = t.visitorText;
            document.getElementById('qtyHeader').textContent = t.qtyHeader;
            document.getElementById('priceHeader').textContent = t.priceHeader;

            // Update features
            const featuresList = document.getElementById('featuresList');
            featuresList.innerHTML = t.features.map(f => `<li>${f}</li>`).join('');

            // Update dynamic form labels
            document.querySelectorAll('.item-row').forEach(row => {
                const colorSelect = row.querySelector('.item-color');
                const sizeSelect = row.querySelector('.item-size');
                const qtyInput = row.querySelector('.item-qty');

                // Save state
                const colorIndex = colorSelect.selectedIndex;
                const sizeIndex = sizeSelect.selectedIndex;

                // Update Colors
                const colorOpts = t.colors.map(c => `<option value="${c}">${c}</option>`).join('');
                colorSelect.innerHTML = `<option value="" disabled>${t.lblColor}</option>${colorOpts}`;
                colorSelect.selectedIndex = colorIndex;

                // Update Sizes
                const sizeOpts = t.sizes.map(s => `<option value="${s}">${s}</option>`).join('');
                sizeSelect.innerHTML = `<option value="" disabled>${t.lblSize}</option>${sizeOpts}`;
                sizeSelect.selectedIndex = sizeIndex;

                // Update Qty
                qtyInput.placeholder = t.lblQty;
            });

            // Re-render pricing table to update currency
            renderPricingTable();
            updateOrderSummary(); // Update summary on language switch
        }

        // --- Gallery ---
        function changeImage(thumb) {
            document.getElementById('mainImage').src = thumb.src;
            document.querySelectorAll('.thumb').forEach(t => t.classList.remove('active'));
            thumb.classList.add('active');
        }

        // --- Pricing Table ---
        function renderPricingTable() {
            const tbody = document.getElementById('pricingBody');
            tbody.innerHTML = CONFIG.prices.map(p => `
                <tr>
                    <td>${p.qty} ${currentLang === 'ar' ? 'قطع' : 'pcs'}</td>
                    <td>${p.price} ${currentLang === 'ar' ? 'ج' : 'EGP'}</td>
                </tr>
            `).join('');
        }

        // --- Visitor Counter ---
        function initVisitorCounter() {
            let count = localStorage.getItem('visitorCount');
            if (!count) {
                count = Math.floor(Math.random() * 500) + 1000; // Fake start
                localStorage.setItem('visitorCount', count);
            } else {
                // Increment only if new session (simplified here: just increment)
                if (!sessionStorage.getItem('visited')) {
                    count = parseInt(count) + 1;
                    localStorage.setItem('visitorCount', count);
                    sessionStorage.setItem('visited', 'true');
                }
            }
            document.getElementById('visitorCount').textContent = count;
        }

        // --- Countdown Timer ---
        function initCountdown() {
            // Set end time to 27 hours from now if not set
            let endTime = localStorage.getItem('offerEndTime');
            if (!endTime) {
                const now = new Date();
                now.setHours(now.getHours() + CONFIG.countdownHours);
                endTime = now.getTime();
                localStorage.setItem('offerEndTime', endTime);
            }

            const timerEl = document.getElementById('timer');

            setInterval(() => {
                const now = new Date().getTime();
                const distance = endTime - now;

                if (distance < 0) {
                    // Reset or show ended
                    timerEl.textContent = "00:00:00";
                    return;
                }

                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                timerEl.textContent = `${days > 0 ? days + 'd ' : ''}${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // --- Order Form Logic ---
        function addOrderItem() {
            const container = document.getElementById('orderItems');
            const div = document.createElement('div');
            div.className = 'item-row';

            // Color Options
            const colorOpts = TEXTS[currentLang].colors.map(c => `<option value="${c}">${c}</option>`).join('');
            // Size Options
            const sizeOpts = TEXTS[currentLang].sizes.map(s => `<option value="${s}">${s}</option>`).join('');

            div.innerHTML = `
                <div class="form-group">
                    <select class="form-control item-color" required>
                        <option value="" disabled selected>${TEXTS[currentLang].lblColor}</option>
                        ${colorOpts}
                    </select>
                </div>
                <div class="form-group">
                    <select class="form-control item-size" required>
                        <option value="" disabled selected>${TEXTS[currentLang].lblSize}</option>
                        ${sizeOpts}
                    </select>
                </div>
                <div class="form-group">
                    <input type="number" class="form-control item-qty" placeholder="${TEXTS[currentLang].lblQty}" value="1" min="1" required>
                </div>
                <button type="button" class="remove-btn" onclick="this.parentElement.remove()">X</button>
            `;
            container.appendChild(div);
            updateOrderSummary(); // Update summary on add
        }

        // --- Order Summary Logic ---
        function updateOrderSummary() {
            let totalQty = 0;
            document.querySelectorAll('.item-qty').forEach(input => {
                totalQty += parseInt(input.value) || 0;
            });

            // Find price tier
            const tier = CONFIG.prices.find(p => p.qty === totalQty);
            let totalPrice = 0;

            if (tier) {
                totalPrice = tier.price;
            } else if (totalQty > 10) {
                // Fallback for > 10 (using lowest unit price approx 80)
                totalPrice = totalQty * 80;
            } else if (totalQty > 0) {
                // Fallback if exact match not found but < 10 (shouldn't happen with current config)
                totalPrice = totalQty * 150;
            }

            const summaryHTML = `
                <div>${currentLang === 'ar' ? 'إجمالي العدد:' : 'Total Qty:'} ${totalQty}</div>
                <div class="summary-total">${currentLang === 'ar' ? 'الإجمالي:' : 'Total:'} ${totalPrice} ${currentLang === 'ar' ? 'ج' : 'EGP'}</div>
            `;

            let summaryDiv = document.getElementById('orderSummary');
            if (!summaryDiv) {
                summaryDiv = document.createElement('div');
                summaryDiv.id = 'orderSummary';
                summaryDiv.className = 'order-summary';
                document.getElementById('orderItems').after(summaryDiv);
            }
            summaryDiv.innerHTML = summaryHTML;
        }

        // Add event listeners for dynamic inputs
        document.addEventListener('input', (e) => {
            if (e.target.classList.contains('item-qty')) {
                updateOrderSummary();
            }
        });

        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('remove-btn')) {
                setTimeout(updateOrderSummary, 100); // Wait for removal
            }
        });

        // --- Lightbox Logic ---
        let currentImageIndex = 0;
        const images = [
            "images/newimages/product_1.jpg", "images/newimages/product_2.jpg", "images/newimages/product_3.jpg",
            "images/newimages/product_4.jpg", "images/newimages/product_5.jpg", "images/newimages/product_6.jpg",
            "images/newimages/product_7.jpg", "images/newimages/product_8.jpg", "images/newimages/product_9.jpg",
            "images/newimages/product_10.jpg"
        ];

        // Open lightbox on main image click
        document.getElementById('mainImage').onclick = function () {
            // Find current index based on src
            const src = this.getAttribute('src');
            currentImageIndex = images.findIndex(img => src.includes(img));
            if (currentImageIndex === -1) currentImageIndex = 0;
            openLightbox();
        };

        function openLightbox() {
            const lightbox = document.getElementById('lightbox');
            const img = document.getElementById('lightboxImg');
            img.src = images[currentImageIndex];
            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden'; // Prevent scrolling
        }

        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            const img = document.getElementById('lightboxImg');
            lightbox.classList.remove('active');
            img.classList.remove('zoomed'); // Reset zoom
            document.body.style.overflow = '';
        }

        function changeSlide(n) {
            // Reverse direction for RTL
            const direction = document.documentElement.dir === 'rtl' ? -n : n;
            currentImageIndex += direction;
            if (currentImageIndex >= images.length) currentImageIndex = 0;
            if (currentImageIndex < 0) currentImageIndex = images.length - 1;

            const img = document.getElementById('lightboxImg');
            img.classList.remove('zoomed'); // Reset zoom on slide change
            img.src = images[currentImageIndex];
        }

        function toggleZoom() {
            const img = document.getElementById('lightboxImg');
            img.classList.toggle('zoomed');
        }

        // Close on background click
        document.getElementById('lightbox').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) {
                closeLightbox();
            }
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (!document.getElementById('lightbox').classList.contains('active')) return;
            if (e.key === 'Escape') closeLightbox();
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'ArrowRight') changeSlide(1);
        });

        // Touch/Swipe support for mobile
        let touchStartX = 0;
        let touchEndX = 0;

        document.getElementById('lightbox').addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        }, false);

        document.getElementById('lightbox').addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, false);

        function handleSwipe() {
            const swipeThreshold = 50; // Minimum distance for swipe
            const diff = touchStartX - touchEndX;

            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // Swipe left
                    changeSlide(1);
                } else {
                    // Swipe right
                    changeSlide(-1);
                }
            }
        }

        function submitOrder(e) {
            e.preventDefault();

            // Collect User Info
            const name = document.getElementById('fullName').value;
            const phone = document.getElementById('phone').value;
            const gov = document.getElementById('governorate').value;
            const city = document.getElementById('city').value;
            const address = document.getElementById('address').value;

            // Collect Items
            const items = [];
            document.querySelectorAll('.item-row').forEach(row => {
                const color = row.querySelector('.item-color').value;
                const size = row.querySelector('.item-size').value;
                const qty = row.querySelector('.item-qty').value;
                items.push(`- ${qty}x ${color} (${size})`);
            });

            if (items.length === 0) {
                alert(currentLang === 'ar' ? 'من فضلك أضف منتج واحد على الأقل' : 'Please add at least one item');
                return;
            }

            // Format Message
            const header = currentLang === 'ar' ? 'طلب جديد من الموقع:' : 'New Order from Website:';
            const msg = `
*${header}*

*👤 Customer:* ${name}
*📞 Phone:* ${phone}
*📍 Address:* ${gov}, ${city}, ${address}

*🛒 Order Details:*
${items.join('\n')}

------------------------
Elbadr Fashion
            `.trim();

            // Redirect
            const url = `https://wa.me/${CONFIG.whatsappNumber}?text=${encodeURIComponent(msg)}`;
            window.open(url, '_blank');
        }
    </script>
</body>

</html>